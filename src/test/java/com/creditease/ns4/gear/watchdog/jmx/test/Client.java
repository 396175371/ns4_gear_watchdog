package com.creditease.ns4.gear.watchdog.jmx.test;import com.creditease.ns4.gear.watchdog.jmx.HelloMBean;import javax.management.*;import javax.management.remote.JMXConnector;import javax.management.remote.JMXConnectorFactory;import javax.management.remote.JMXServiceURL;import java.util.Iterator;import java.util.Set;/** * @author * @description * @date 2019/3/1 */public class Client {    public static void main(String[] args) throws Exception {        //connect JMX        JMXServiceURL url = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://localhost:8888/server");        JMXConnector jmxc = JMXConnectorFactory.connect(url, null);        MBeanServerConnection mbsc = jmxc.getMBeanServerConnection();//        ObjectName mbeanName = new ObjectName("jmxBean:name=hello");//        //print domains//        System.out.println("Domains:---------------");//        String domains[] = mbsc.getDomains();//        for (int i = 0; i < domains.length; i++) {//            System.out.println("\tDomain[" + i + "] = " + domains[i]);//        }//        //MBean count//        System.out.println("MBean count = " + mbsc.getMBeanCount());////        //process attribute//        mbsc.setAttribute(mbeanName, new Attribute("Name", "new value"));//set value//        System.out.println("Name = " + mbsc.getAttribute(mbeanName, "Name"));//get value////        //invoke via proxy//        HelloMBean proxy = MBeanServerInvocationHandler.newProxyInstance(mbsc, mbeanName, HelloMBean.class, false);//        proxy.helloWorld();//        proxy.helloWorld("I'll connect to JMX Server via client.");////        //invoke via rmi//        mbsc.invoke(mbeanName, "helloWorld", null, null);//        mbsc.invoke(mbeanName, "helloWorld", new Object[]{"I'll connect to JMX Server via client2."}, new String[]{String.class.getName()});////        //get mbean information//        MBeanInfo info = mbsc.getMBeanInfo(mbeanName);//        System.out.println("Hello Class:" + info.getClassName());//        System.out.println("Hello Attriber:" + info.getAttributes()[0].getName());//        System.out.println("Hello Operation:" + info.getOperations()[0].getName());////        //ObjectName of MBean//        System.out.println("all ObjectName:---------------");//        Set set = mbsc.queryMBeans(null, null);//        for (Iterator it = set.iterator(); it.hasNext(); ) {//            ObjectInstance oi = (ObjectInstance) it.next();//            System.out.println("\t" + oi.getObjectName());//        }        try {            ObjectName clientName = new ObjectName("jmxBean:name=client");            Set<ObjectName> son = mbsc.queryNames(clientName, null);            if (son.size() > 0) {                mbsc.unregisterMBean(clientName);            }            mbsc.createMBean("com.creditease.ns4.gear.watchdog.jmx.Hello", clientName, new Object[]{"pid"}, new String[]{"java.lang.String"});        } catch (Exception e) {            e.printStackTrace();        }        jmxc.close();    }}